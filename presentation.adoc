= 候選人 Excel 文件生成專案說明
Oscar Wang
:doctype: book
:toc: left
:toclevels: 3

== 專案概述
這個專案是一個 Java 應用 程式，用於根據候選人的履歷資料生成 Excel 文件。每個文件包含個人資訊、教育背景、工作經歷、技能和專案等多個部分。該 Excel 文件的生成使用了 **Apache POI** 庫，同時實現了 **建造者模式** (Builder Design Pattern)，使得文件的內容建構變得模組化和易於維護。

== 使用技術
* Java
* Apache POI（用於 Excel 文件生成）
* AsciiDoc（用於文件說明）

== 專案結構
本專案的結構分為幾個主要套件：

- `builder`:: 包含用於建造者設計模式的類別，負責 Excel 文件的建構流程。
- `model`:: 保存候選人的資料模型，包括 `Candidate`、`Education`、`Experience` 等。
- `component`:: 定義 Excel 文件的各個部分，例如 `PersonalInfoSection` 和 `ExperienceSection`。
- `excel`:: 管理 `ExcelFile` 類別，用於封裝 Apache POI 的工作簿創建。
- `style`:: 實現 `StyleBuilder`，用於在內容生成後對 Excel 單元格進行流暢的自定義樣式設定。
- `service`:: 包含 `ExcelGenerationService`，負責組織 Excel 文件的生成並應用樣式。

== 設計模式：建造者模式
我們在這個專案中選擇使用 **建造者模式**，原因在於它能將複雜 Excel 文件物件的構建過程與表現形式分離。這種設計方法能夠讓 Excel 文件生成邏輯保持靈活且模組化，使得我們可以輕鬆地新增、移除或修改生成邏輯，而不影響程式碼的其他部分。

=== 選擇建造者模式的過程
我在選擇設計模式的過程中，首先諮詢了 ChatGPT，以了解哪些設計模式可能最適合這個專案的需求。ChatGPT 建議我們使用建造者模式，因為它特別適合需要逐步構建多個不同部分的複雜物件。隨後，我進一步查閱了建造者模式與其他創建模式的比較，確認了建造者模式在這個專案中最為合適，以下是具體原因：

1. **工廠模式 (Factory Pattern)**：工廠模式旨在簡化單一物件的創建過程，根據傳入參數來決定創建哪種類型的物件。這種模式適用於生成特定類型的物件，而非具有多步驟、多部分的組合物件。在這個專案中，Excel 文件包含多個具體部分（例如個人資訊、教育、工作經歷等），每一部分有不同的數據和格式需求，因此工廠模式並不適合。

2. **抽象工廠模式 (Abstract Factory Pattern)**：抽象工廠模式能夠生成一組相互關聯的物件，並根據具體環境產生不同的物件組合。這個模式更適合需要同時創建多個相互關聯的類別，通常用於跨平台的情況。然而，本專案並非要創建一組變體物件，而是逐步構建具有多個部分的單一物件，因此抽象工廠模式並不適用。

3. **單例模式 (Singleton Pattern)**：單例模式的目的是確保一個類別只有一個實例，適合全域共享的情境。然而，在構建多個段落的 Excel 文件時，不需要僅限於單一實例，因此單例模式不適合用於此專案。

4. **原型模式 (Prototype Pattern)**：原型模式通過複製現有的物件來生成新物件，適用於創建新物件成本較高的情境。由於每個候選人文件的內容是唯一的，並且需要根據動態資料生成，因此單純的複製並不符合需求，原型模式也不適用。

**建造者模式 (Builder Pattern)** 在此專案中是最合適的選擇，因為它允許將一個複雜物件的構建過程拆分為多個步驟。在我們的場景中，Excel 文件需要分部分逐步生成，並且各部分的資料和格式不同。使用建造者模式，我們能夠模組化地構建 Excel 文件的每一部分，保持生成過程的靈活性。此外，建造者模式可以將構建過程與 Excel 文件的最終表現分離，這意味著可以在不改變整體生成流程的情況下，自由修改或新增文件中的具體部分。

== 建造者模式的組成部分
- **ExcelBuilder (抽象建造者)**:: 定義了建構 Excel 文件所需的方法，如 `buildHeader()`、`buildSections()` 和 `buildFooter()`。
- **ConcreteExcelBuilder (具體建造者)**:: 實現各個 Excel 部分的具體生成邏輯。它創建並填充每個部分，然後將其組織成最終的 Excel 文件。
- **ExcelDirector (指導者)**:: 管理建構過程，確保每個步驟按正確的順序完成。
- **ExcelFile (產品)**:: 封裝了 Apache POI 的工作簿，並提供創建工作表和保存文件的方法。

這種設計模式增強了模組化，使得程式碼在新增 Excel 部分或格式時更加靈活且易於擴展。

== 專案組成部分

=== 模型套件 (`model`)
`model` 套件包含代表候選人相關資料的類別，包括：

- `Candidate`:: 包含候選人具體資訊，例如姓名、地址，以及教育、工作經歷、技能和專案的列表。
- `Education`:: 存儲候選人的教育背景，包括學校名稱、學位、`LocalDate` 開始和結束日期。
- `Experience`:: 表示候選人的工作經歷，包括公司名稱、職位、開始和結束日期等。
- `Skill` 和 `Project`:: 分別儲存候選人的技能和專案經歷。
- `Address`:: 儲存地址的詳細資訊，例如街道、城市、郵遞區號和國家。

=== 組件套件 (`component`)

`component` 套件中的每個類別代表 Excel 文件中的一個部分。這些類別繼承自一個抽象的 `AbstractSection` 類別，每個具體部分類別都實現了自己的內容生成邏輯。這些類別包括：

- `PersonalInfoSection`:: 填充候選人的個人資訊。
- `ExperienceSection`:: 添加候選人的工作經歷行。
- `EducationSection`:: 添加每個學歷背景的行。
- `ProjectSection`:: 添加每個候選人所完成的專案行。
- `SkillSection`:: 添加每項技能行。

每個部分都負責其在 Excel 表中的內容生成。

=== Excel 套件 (`excel`)
`ExcelFile` 類別封裝了 Apache POI 的 `XSSFWorkbook`，並提供管理工作簿的方法，例如創建工作表和將文件保存到磁碟。

=== 樣式套件 (`style`)
此套件中的 `StyleBuilder` 類別提供了一個 **流暢 API** 用於自定義 Excel 單元格的樣式。這種方法可以輕鬆地設定樣式，例如加粗標題、調整字體大小、設定邊框等。樣式是在內容生成後應用的，這樣使數據和展示風格能夠清晰分離。

=== 服務套件 (`service`)
`ExcelGenerationService` 類別負責整個 Excel 生成過程，包括：

1. 初始化建造者和指導者來建構文件。
2. 使用 `StyleBuilder` 為部分和單元格應用一致的樣式。
3. 保存生成的文件。

== 專案運行方式
要運行此專案：

1. `clone` 專案倉庫並導航到專案目錄。
2. 確保已安裝所需的依賴。
3. 運行 `Main` 類別，以生成包含示例數據的 Excel 文件。
4. 應該在專案目錄中看到生成的文件 `candidate_info.xlsx`。

== 未來改進
該專案的潛在擴展方向包括：

- 增加對更多部分的支持，例如認證或獎項。
- 強化 `StyleBuilder`，以支持更多樣式，例如單元格背景顏色或自定義字體。
- 實施候選人數據的驗證規則，以確保數據的完整性和準確性。

== 結論
本專案展示了 **建造者模式** 的有效應用，用於結構化且模組化地構建複雜的 Excel 文件。此模式結合了流暢的 `StyleBuilder`，使數據生成和展示風格分離清晰，從而讓專案更易於維護、擴展和自定義。
